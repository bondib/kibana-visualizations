<div ng-controller="TrafficLightVisController" class="traffic-light-vis">
    <div class="metric-container" ng-repeat="metric in metrics">
        <!-- height = width * 2.68 -->
        <!-- light width 0.68% of traffic light width -->
        <style>
            
            
            
        </style>
        <div class="traffic-light-container" ng-style="{'width': vis.params.width+'px', 'height': ((vis.params.redAndGreenOnly ? 1.7688 : 2.68) * vis.params.width)+'px'}" ng-class="{'rotate-horizontal': vis.params.rotateHorizontaly}">
            <div class="traffic-light">
                <div class="light red" ng-class="{'on': (!vis.params.invertScale && metric.value <= vis.params.redThreshold) || (vis.params.invertScale && metric.value >= vis.params.redThreshold),
                    'two-state': vis.params.redAndGreenOnly }"></div>
                <div ng-show="!vis.params.redAndGreenOnly" class="light yellow" ng-class="{'on': (!vis.params.invertScale && metric.value > vis.params.redThreshold && metric.value < vis.params.greenThreshold) || (vis.params.invertScale && metric.value < vis.params.redThreshold && metric.value > vis.params.greenThreshold) }"></div>
                <div class="light green" ng-class="{'on': (vis.params.redAndGreenOnly && ((!vis.params.invertScale && metric.value > vis.params.redThreshold) || (vis.params.invertScale && metric.value < vis.params.redThreshold))) || 
                 (!vis.params.redAndGreenOnly && ((!vis.params.invertScale && metric.value >= vis.params.greenThreshold) || (vis.params.invertScale && metric.value <= vis.params.greenThreshold))) ,
                 'two-state': vis.params.redAndGreenOnly}"></div>
            </div>
        </div>
        <div>{{metric.label}}</div>       
    </div>
</div>